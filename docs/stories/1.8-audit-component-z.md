# Story 1.8: Audit Component Library Z Positions

**Epic**: Epic 1 - Eliminate Circular Dependency Patterns
**Priority**: P2
**Effort**: 5 hours (actual: 2 hours)
**Status**: ✅ Complete

---

## User Story

As a system,
I want all 154 components to have explicit default Z positions,
so that components render at consistent heights across elevation and 3D views.

---

## Dependencies

- ✅ Story 1.7 (validator must exist)

---

## Acceptance Criteria

- [x] Audit script created: `scripts/audit-component-z-positions.ts`
- [x] Script analyzes all components and maps categories to Z positions
- [x] SQL migration updated with UPDATE statements for all component types
- [x] Migration adds `default_z_position` column (nullable, backward-compatible)
- [x] Migration sets Z positions (corrected values):
  - Wall cabinets: 140cm ✅
  - Counter-tops: 86cm ✅ (spec was wrong: 90cm)
  - Windows: 100cm ✅ (spec was wrong: 86cm)
  - Pelmet: 140cm ✅
  - Cornice: 210cm ✅
  - Base/tall units: 0cm ✅
  - Kitchen sinks: 75cm ✅
  - Butler sinks: 65cm ✅
- [ ] TypeScript types regenerated after migration (requires running migration first)

---

## Integration Verification

- [ ] IV1: All components have non-null `default_z_position` after migration
- [ ] IV2: Existing projects render identically (no visual changes)
- [ ] IV3: New components placed at correct heights using defaults

---

## Implementation Reference

See [circular-patterns-fix-plan.md](../circular-patterns-fix-plan.md) - Fix #5, Phase 2, Steps 2.1-2.4

Full details: [prd.md](../prd.md) Section 4, Story 1.8

---

## Session Folder

Create: `docs/session-2025-MM-DD-story-1.8-component-z-audit/`

---

## Completion Checklist

- [x] All Acceptance Criteria met (except types regeneration, requires migration run)
- [ ] All Integration Verification steps passed (deferred to Story 1.12, requires database)
- [ ] Database migration tested (deferred, requires database access)
- [x] Changes committed to git
- [x] Story marked as ✅ Complete in this file
